## Barra 因子模型

[参考资料](https://zhuanlan.zhihu.com/p/38280638)， [求解过程资料](https://zhuanlan.zhihu.com/p/39922829), [一篇研报](https://www.hangyan.co/reports/3502464208883156485)

本文复制粘贴了很多第一篇参考资料的内容。

Barra 因子模型 **不是** 在尝试构建一个盈利的投资组合，它更多的用来评估一个投资组合的风险，或配合组合优化控制一个投资组合的风险。

所谓因子，就是一个可以描述股票某方面特征的因素， 以市值为例子，A公司市值是 10B，就说市值因子在A公式的暴露是 10B.

对于给定的因子，如何构建因子投资组合呢？常见的做法是，将所有个股在该因子上的因子暴露在截面上标准化；之后所有股票会按照因子的业务逻辑、根据因子暴露的数值从好到坏排列；最后，假设做多前 10% 或者 20% 的股票，做空后 10% 或者 20% 的股票，以此来构建一个零额投资的投资组合，它就是该因子的投资组合。

如果我们现在就检验按市值因子买入股票的截面策略，评判市值因子，用上述的投资组合评判市值因子的能力，存在两个问题。

1. 市值因子带来的盈利在变动，你的投资组合在是市值因子上面的总暴露也在变动，你无法确定你的投资组合盈利增加是因为 这个因子的盈利能力增加 还是 市值增长本身带来的效果。

2. 市值大的公司可能存在别的因子也很大的影响，这个投资组合并不是最有效的 **只** 评判市值因子的 **盈利能力** 的组合。

为此，Barra 提出了纯因子模型（pure factor model），它能够保证在截面上构建因子投资组合时，每个因子的投资组合对目标因子有 1 个单位的暴露，而对其他因子的暴露为 0*。

* 严谨的说，根据因子的性质不同（即国家因子、行业因子、风格因子），因子的投资组合在其他因子上是否完全为 0 单位暴露略有差异（下文会具体说明）。但这不影响我们从广义上说“Barra 的模型中，因子的投资组合对目标因子有 1 个单位的暴露，对其他因子没有暴露”。这就是纯因子模型中“纯”字的含义。

### 1. 模型构建

CNE5是Barra的最新一代面向中国股票市场的多因子模型。该模型考虑了一个国家因子、多个行业因子以及多个风格因子。假设市场中共有N支股票，P个行业，以及Q个风格因子。在任意给定时间点，该模型使用因子暴露和个股收益率构建截面回归 (cross-sectional regression) 如下:

$$
\begin{bmatrix}
r_1 - r_f\\
r_2 - r_f\\
\vdots\\
r_N - r_f
\end{bmatrix}
=
\begin{bmatrix}
1\\
1\\
\vdots\\
1
\end{bmatrix}
f_C
+
\begin{bmatrix}
X_1^{I_1}\\
X_2^{I_1}\\
\vdots\\
X_N^{I_1}
\end{bmatrix}
f_I
+
\cdots
+
\begin{bmatrix}
X_1^{I_P}\\
X_2^{I_P}\\
\vdots\\
X_N^{I_P}
\end{bmatrix}
f_{I_P}
+
\begin{bmatrix}
X_1^{S_1}\\
X_2^{S_1}\\
\vdots\\
X_N^{S_1}
\end{bmatrix}
f_S
+
\cdots
+
\begin{bmatrix}
X_1^{S_Q}\\
X_2^{S_Q}\\
\vdots\\
X_N^{S_Q}
\end{bmatrix}
f_{S_Q}
+
\begin{bmatrix}
u_1\\
u_2\\
\vdots\\
u_N
\end{bmatrix}
$$

### 2. 模型解释

Barra多因子模型将个股的超额收益率分解为共同因子收益和个股特异性收益两部分：
$R_{i,t} = \sum_{k=1}^{K} \beta_{i,k,t} f_{k,t} + u_{i,t}$

其中：

$R_{i,t}$：股票 $i$ 在时期 $t$ 的超额收益率

$\beta_{i,k,t}$：股票 $i$ 在时期 $t$ 对因子 $k$ 的暴露（Exposure）

$f_{k,t}$：因子 $k$ 在时期 $t$ 的收益率

$u_{i,t}$：股票 $i$ 在时期 $t$ 的特质收益率

所有股票在国家因子上暴露都是1， 一个行业上所有股票在该行业上因子暴露是1，在其他行业上因子暴露是0.

风格因子用来表述股票的一些特征。

| 因子类别 (Category) | CNE5 因子 | CNE6 因子 (示例) | 一般含义 (General Interpretation) |
| :--- | :--- | :--- | :--- |
| **价值** | Book-to-Price | 每股盈利、现金流等 | 衡量公司相对价值。 |
| **规模** | Size | 市值、总资产等 | 公司市值大小。 |
| **动量** | Momentum | 12个月动量、1个月反转等 | 股票过去价格走势趋势。 |
| **波动率** | Residual Volatility | 贝塔、日波动率等 | 股价的波动程度。 |
| **流动性** | Liquidity | 换手率、Amihud指标等 | 股票交易的活跃程度。 |
| **质量** | Earnings Yield | 盈利能力、杠杆率等 | 公司的财务健康状况。 |
| **成长** | Growth | 营收增长率、盈利增长率等 | 公司未来的增长潜力。 |
| **杠杆** | Leverage | 资产负债率、市值杠杆等 | 公司的财务风险水平。 |
| **其他** | - | 分析师预期、股息率等 | 包含其他市场关注的特征。 |


由于行业因子的暴露和国家因子的暴露存在完全共线性关系，故增加约束条件，施加约束 $\sum s_{I_p} * f_{I_p} = 0$（行业因子收益率按行业市值加权和必须为0）。值得指出的是，你可以任意施加一个约束条件，只要保证有解即可，但是这么施加约束条件才能保证纯因子中 **纯** 的性质，会在后文提到。

### 3. 模型目的

在保证了上述约束条件和后文的一些标准化处理之后，用最小二乘法可以求解出来因子的收益率。

### 4. **纯**

#### 保证任何一个风格因子按市场投资（即按流通市值配比）的暴露都是 0

这个通过标准化实现。

$X_{nk}=\frac{X_{nk}^{\text{Raw}}-\mu_{k}}{\sigma_{k}} \quad \mu_{k}=\sum_{n=1}^{N}w_{n}X_{nk}^{\text{Raw}}$
其中：

- $\sigma_{k}$ 代表**等权标准差**
- $\mu_{k}$ 是根据**自由流通市值加权**计算的均值

使用自由流通市值加权而不是一般常用的等权，是希望市场基准组合对各个风格因子的暴露为 0。除了描述变量以外，在每一次加权合成风格因子和大类因子时，也要进行一次标准化的处理，从而保证市值加权均值为 0 的性质。

#### 求解出来的国家因子

参考第一篇文章，可以知道国家因子的投资组合约等于按照市值配比去投资。实际意义是整个市场的情况。

#### 求解出来的行业因子

由于约束的存在，保证了行业因子是 100% 做多该行业 + 100% 做空全市场，实际意义是仅考虑当前行业的超额收益。

至于纯因子的性质保证（保证该投资组合对该因子的暴露为 1；保证该投资组合对其他因子的因子暴露为 0。） 从数学上看，第二篇文章的求解公式蕴含着 omega * X * R = R, 代表了 omega * X 在R的约束下满足单位性质。

### 5. 求解细节

这个直接参考第二篇参考文章。

### 6. 模型意义

通过求解纯因子的回归方程，把每个因子的收益率用一个投资组合表示，进而可以分析每个因子带来的实际收益和风险。更多用来分析投资因子的性质和控制风险。